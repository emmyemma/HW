<html>
    <script src="https://cunning-wolf-50qhhu-dev-ed.trailblaze.my.site.com/lightning/lightning.out.js"></script>
    <div data-lightning-out="true"></div>
    <script>
        
        const domainName = 'cunning-wolf-50qhhu-dev-ed.trailblaze.lightning.force.com';
        const response_type = 'code';
        const client_id = '3MVG9ux34Ig8G5eoAUalnJI3xuV1f6AdldGsAIBW54QigSpW1W0B9rCawuuRFZ.ls.btbUdurx3x3B2vA_wG0';
        const redirect_uri = 'https://emmyemma.github.io/HW/';
        const url1 = 'https://' + domainName + '/services/oauth2/authorize?client_id=' + client_id + '&redirect_uri=' + redirect_uri + '&response_type=' + response_type; 

        // If access code is not yet received, make user login.
        if(!window.location.href.includes('code')) window.location.replace(url1);

        const queryString = window.location.search;
        const urlParams = new URLSearchParams(queryString);
        const client_secret = '89A1CDA8BE3B59E8483F173BBB1AC741E93866E388B8FB9DD904538F6A58E86B';
        const code = urlParams.get('code');
        var params = "grant_type=authorization_code&code=" + code + "&client_id=" + client_id + "&client_secret=" + client_secret + "&redirect_uri=" + redirect_uri;

        var respo = "";
        // Function to send post request to get auth token
        async function getIt() {
        const response = await fetch("https://cunning-wolf-50qhhu-dev-ed.trailblaze.my.salesforce.com/services/oauth2/token", {
            method: 'POST',
            headers: {
              'Content-Type': 'application/x-www-form-urlencoded'
            },
            body: params,
            });
            
            response.json().then(data => {
                respo = JSON.parse(data);
              console.log(JSON.stringify(data));
            });
        }
        getIt();
        auth_token = respo['access_token'];
        console.log(auth_token);
        
    </script> 
</html>
