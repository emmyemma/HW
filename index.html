<html>
    <script src="https://cunning-wolf-50qhhu-dev-ed.trailblaze.my.site.com/lightning/lightning.out.js"></script>
    <div data-lightning-out="true"></div>
    <script>
        let str = window.location.href;
        if(!str.contains("code")) {
            //Obtain authorization code 
            redirectUrl = 'https://prism-petsmart--ehanretty.sandbox.salesforce.com/services/oauth2/authorize?client_id=3MVG9OI03ecbG2VpSxAekLC2d0bxtjRgDhV5sYYXjliaLhV.qWXA1dhCIVUyci0jifq3mCXvOg5p9sIu6c2b1&redirect_uri=https://emmyemma.github.io/HW&response_type=code';
            window.location = redirectUrl;
        } else {
            // get auth code from URL
            const params = new URLSearchParams(window.location.search);
            const code = params.get("code");
            
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "https://prism-petsmart--ehanretty.sandbox.salesforce.com/services/oauth2/token");
            xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
            const body = 'grant_type=authorization_code&code=aPrxhgZ2MIpkSy0aOdn07LjKFvsFOis6RGcWXz7p8JQCjcqfed5NQLe7sxWwMY_JQFuLwHRaRA' + code + '&client_id=3MVG9OI03ecbG2VpSxAekLC2d0bxtjRgDhV5sYYXjliaLhV.qWXA1dhCIVUyci0jifq3mCXvOg5p9sIu6c2b1&client_secret=C7F286A806C9699A840295667FD7427CA5F00664E5790B8197F3923BE419F92F&redirect_uri=https://emmyemma.github.io/HW';
            xhr.onload = () => {
              if (xhr.readyState == 4 && xhr.status == 201) {
                console.log(JSON.parse(xhr.responseText));
              } else {
                console.log(`Error: ${xhr.status}`);
              }
            };
            xhr.send(body);
        }
    </script> 
</html>
